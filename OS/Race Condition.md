# Race Condition

### 1. 개요

- 두 개 이상의 프로세스가 공통 자원을 병행적으로(concurrently) 읽거나 쓰는 동작을 할 때, 공용 데이터에 대한 접근이 어떤 순서에 따라 이루어졌는지에 따라 그 실행 결과가 같지 않고 달라지는 상황
  - Race : 두 개 이상의 스레드가 하나의 자원을 놓고 서로 사용하기 위해 경쟁하는 상황



### 2. 발생하는 경우

1. **커널 코드 실행 중에 인터럽트가 발생하는 경우**
   - 커널이 가진 전역변수는 모든 프로세스의 공유물이므로 경쟁 상태의 가능성이 존재
   - 커널 모드에서 작업을 수행하는 동안 인터럽트를 disable 시켜 인터럽트가 CPU 제어권을 가져가지 못하도록 막는 것으로 해결
2. **프로세스가 시스템 콜을 하여 커널 모드로 진입해서 작업을 수행하는 도중에 문맥 교환이 발생할 경우**
   - 프로세스1이 커널 모드에서 데이터를 조작하던 도중 시간이 초과되어 CPU 제어권이 프로세스2로 넘어가 같은 데이터를 조작하는 경우
   - 프로세스가 커널 모드에서 작업을 하는 경우에는 시간이 초과되더라도 CPU 제어권이 다른 프로세스에게넘어가는 것을 막는 것으로 해결
3. **멀티 프로세서에서 공유 메모리 내의 커널 데이터에 접근할 경우**
   - 멀티 프로세스 환경에서 2개의 CPU가 동시에 커널 내부의 공유 데이터에 접근하여 조작하는 경우 발생할 수 있다.
   - 커널 내부에 있는 각 공유 데이터에 접근할 때마다 그 데이터에 대해 lock/unlock함으로써 해결





### 참조

https://iredays.tistory.com/125

https://velog.io/@klloo/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B2%BD%EC%9F%81-%EC%83%81%ED%83%9C-Race-Condition